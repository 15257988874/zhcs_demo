var app=ycya.page||{};app.ui={version:"0.8.5",anim:4,formSelectsCfg:{type:"get",data:{},searchUrl:"",searchName:"",keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",delay:500,direction:"down",success:function(t,e,i,a){},error:function(t,e,i,a){layer.msg(a)},beforeSuccess:function(t,e,i,a){return a},beforeSearch:function(t,e,i){return!0},clearInput:!0}},app.ui.page={};var IFormItem=new Interface("IFormItem",["get","getJson","getArray","set","reset","init"]);(function(t){var e=function(t,e){this.pdom=t,this.cfg=e,this.dom=[],"btw"==e.qt?this.id=["qry_"+this.cfg.name+"_gt","qry_"+this.cfg.name+"_lt"]:this.id=["qry_"+this.cfg.name+"_"+e.qt],this._init()};e.prototype={_init:function(){for(var t=this.cfg.len?"style='width:"+this.cfg.len+"px'":"",e='<div class="yy-m-search-item"><label>'+this.cfg.label+"&nbsp;</label><div>",i=0;i<this.id.length;i++)i>0&&(e+="至"),e+='<input type="text" id="'+this.id[i]+'" autocomplete="off" class="layui-input" '+t+">";if(e+="</div></div>",$(".yy-m-search",this.pdom).prepend(e),"date"==this.cfg.dt)for(var a=layui.laydate,i=0;i<this.id.length;i++){var s={elem:"#"+this.id[i]};$.extend(s,this.cfg.cfg),a.render(s)}else{var n=this;this.cfg.click&&(n.cfg.treeCfg?$("#"+this.id[0]).click(function(){n.cfg.click($.extend(n.cfg.treeCfg,{elm:$(this)}))}):$("#"+this.id[0]).click(function(){n.cfg.click()}))}return this},get:function(t){return this.getArray().join(t?t:",")},getArray:function(){for(var t=[],e=0;e<this.id.length;e++)t.push($("#"+this.id[e]).val());return t},getJson:function(){for(var t={},e=0;e<this.id.length;e++)t[this.id[e]]=$("#"+this.id[e]).val();return t},set:function(t){for(var e=t instanceof Array,i=0;i<this.id.length;i++)$("#"+this.id[i]).val(e?t[i]:t)},reset:function(){for(var t=0;t<this.id.length;t++)$("#"+this.id[t]).val("")}},t.YInput=e;var i=function(t,e){this.cfg=t,this.date=[],this.dateCfg=[],t.qt?this.id=["qry_"+this.cfg.name+"_"+t.qt]:this.id=[this.cfg.name],t.handle&&(this.handle=t.handle),this.eventName=t.eventName?t.eventName:"click",t.treeCfg?this.cfgFn=t.treeCfg:t.cfg?this.cfgFn=t.cfg:this.cfgFn={},this._init(e?e:"msg")};i.prototype={_init:function(t){var e=this.cfg.len?"style='width:"+this.cfg.len+"px'":"",i="",a=this.id.length>1?"input-btw":"",s=this,n=this.cfg.dt?this.cfg.dt:"text",r=this.cfg.cfg;if("text"==n||"date"==n){var l=this.cfg.inputType||"text",o=this.cfg.verify?'lay-verify="'+this.cfg.verify+'"':"",c=this.cfg.placeholder?'placeholder="'+this.cfg.placeholder+'"':"",d=this.cfg.isReadonly?"readonly":"";i+='<input type="'+l+'"  name="'+this.id[0]+'" autocomplete="off"  '+e+"  "+d+" "+o+' class="'+a+'" lay-verType="'+t+'" '+c+">"}else if("switch"==n){if(3!=r.values.length||3!=r.text.length)return new TypeError;var h=r.values.split("|"),p=void 0!==r.checked&&r.checked==h[0]?'checked=""':"",f=void 0!==r.checked&&r.checked==h[0]?h[0]:h[1];i+='<input type="checkbox" '+p+'  value="'+f+'" name="'+this.cfg.name+'"  lay-skin="switch" lay-text="'+r.text+'" data-value="'+r.values+'">',this.switch=this.cfg.name}else if("checkbox"==n){var u=r.skin?'lay-skin="primary"':"";if(r.data&&!r.url){var m=r.checked?r.checked.indexOf("|")==-1?[r.checked]:r.checked.split("|"):[];$.each(r.data,function(t,e){var a=$.inArray(t,m)!=-1?'checked=""':"";i+='<input type="checkbox" name="'+s.cfg.name+'" title="'+e+'" '+u+" "+a+' value="'+t+'">'}),m.length>0&&(this.checkInitVal={name:s.cfg.name,checked:m})}r.url&&(s.checkInitVal={name:s.cfg.name})}else{var h=r.values.split("|"),y=r.text.split("|");if(h.length!=y.length)return new TypeError;$.each(h,function(t,e){var a=e==s.cfg.cfg.checked?'checked=""':"";i+='<input type="radio" name="'+s.cfg.name+'"  value="'+e+'" title="'+y[t]+'" '+a+">"}),this.radioInitVal={name:s.cfg.name,checked:s.cfg.cfg.checked}}if(this.html=i,"date"==this.cfg.dt)for(var g=0;g<this.id.length;g++)this.date.push(this.id[g]),this.cfg.cfg&&this.dateCfg.push(this.cfg.cfg);return this}},t.AQInput=i;var a=function(t,e){e&&(this.pdom=e),t&&(this.cfg=t),this.id=["qry_"+this.cfg.name+"_"+t.qt],this.init()};a.prototype={init:function(){var t=this;return this.cfg.cfg?ycya.http.ajax(this.cfg.cfg.url,{data:this.cfg.cfg.where||{},type:this.cfg.cfg.type||"post",success:function(e){var i;if(t.cfg.cfg.format.indexOf(".")===-1)i=e[t.cfg.cfg.format];else{i=e;for(var a=0;a<t.cfg.cfg.format.split(".").length;a++)i=i[t.cfg.cfg.format.split(".")[a]]}t.createSel(i,t.cfg.cfg.allVal)}}):this.createSel(this.cfg.option),this},getJson:function(){for(var t={},e=0;e<this.id.length;e++)t[this.id[e]]=$("#"+this.id[e]).val();return t},createSel:function(t,e){var i=void 0!==e?["<option value="+e+">全部</option>"]:[],a=this;$.each(t,function(t,e){i.push($("<option value="+e[a.cfg.keyName]+">"+e[a.cfg.valName]+"</option>")[0].outerHTML)});var s=$("<div/>",{class:"yy-m-search-item"}),n=$("<label/>",{text:this.cfg.label}),r=$("<div/>"),l=$("<select/>",{id:this.id[0],html:i.join(""),width:this.cfg.len?this.cfg.len:auto});r.append(l),s.append(n).append(r),$(".yy-m-search",this.pdom).prepend(s)}},t.Yselect=a;var s=function(t){this.cfg=$.extend(!0,{method:"post",accept:"images",acceptMime:"images",auto:!0,multiple:!0},t),this.init()};s.prototype={init:function(){var t=layui.upload,e=t.render(this.cfg);return this._upload=e,this}},t.Yupload=s})(window),function(t){var e=function(t){this.dateList=[],this.dateCfgList=[],this.bindElm=[],this.eventName=[],this.eventFn=[],this.cfgFn=[],this.pwd=[],this.id=[],this.address=[],this.switchList=[],this.selectList=[],this.radioList=[],this.checkList=[],this.selectMap={},this._cfg={isAdvanced:!1,id:"",filter:"",allowEmpty:!1,colWidth:"two",callBack:function(){},submitFn:function(){},verType:"tips",item:[]},$.extend(this._cfg,t),this.loaded=!1;var e=new YcyaLoader;e.loadFileList([getContentPath()+"/res/js/component/advancedQuery/ycyaAq.css"],function(){}),this.init(this._cfg)};e.prototype={init:function(t){var e=this;if("object"!==$.type(t)||""===t.id||!t.item||"array"!==$.type(t.item))throw new Error("参数错误");var i="m-none layui-form"+(t.isAdvanced?" yy-m-aq-advanced-popup":""),a=$('<div class="'+i+'" id='+this._cfg.id+"></div>");$("body").append(a);var s,n=["yy-m-aq-popup","yy-m-aq-"+t.colWidth+"-item"].join(" "),r=$('<ul class="'+n+'"></ul>');if(t.map){r.css({float:"left",width:t.map.lf||300,paddingRight:0,height:t.map.height||300});var l="ycyaPopupMap",o="ycyaFormMap";s=$("<div/>",{id:l,class:"yy-m-form-mapbox"}),s.css({boxSizing:"border-box",display:"inline-block",padding:"5px",width:t.map.rt-20,height:t.map.height||300});var c=$("<div/>",{id:o});c.css({boxSizing:"border-box",height:"100%",width:"100%",border:"1px solid #eee"});var d=!1;if($("script").each(function(){if($(this)[0].outerHTML.indexOf("ycyaMap.js")!==-1)return d=!0,!1}),!d){var h=new YcyaLoader;h.loadFileList([getContentPath()+"/res/dep/ycyaMap/YcyaMap.js"],function(){var t=setInterval(function(){$("#"+e.mapId).length>0&&(e.map=app.ui.map.init({id:e.mapId}),clearInterval(t),t=null)},100)})}s.append(c),this.mapBoxId=l,this.mapId=o}for(var p=0;p<t.item.length;p++){var f=t.item[p];!t.isAdvanced&&f.qt&&delete f.qt;var u=f.verify&&f.verify.indexOf("required")!==-1?'<span class="yy-m-aq-require-option">*</span>':"",m=f.verify?f.verify:"",y=f.isBlock?"block-item layui-form-item":"layui-form-item",g=$('<li class="'+y+'"><label>'+u+f.label+": </label></li>"),v="m-inline-block w-all",x=f.inputType?f.inputType:"text";switch(elmType=f.elmType||"input",verType=t.verType?t.verType:"tips",elmType){case"input":if("text"==x){var b=new AQInput(f,t.verType);b.date.length>0&&(this.dateList.push(b.date),this.dateCfgList.push(b.dateCfg)),(b.handle||f.eventName)&&(this.bindElm.push(b.id[0]),this.eventName.push(b.eventName),this.eventFn.push(b.handle||function(){}),this.cfgFn.push(b.cfgFn)),b.switch&&this.switchList.push(b.switch),b.radioInitVal&&this.radioList.push(b.radioInitVal),b.checkInitVal&&this.checkList.push(b.checkInitVal),b.html?g.append($('<div class="'+v+'">'+b.html+"</div>")):function(t,e){var i="",a=t.cfg.skin?'lay-skin="primary"':"",s=t.cfg.cfg;ycya.http.ajax(t.cfg.url,{data:s.data,type:s.type||"post",success:function(n){var r=s.keyName||"name",l=s.keyVal||"id",o=s.beforeSuccess?s.beforeSuccess(n):n.data||[];$.each(o,function(e,s){i+='<input type="checkbox" name="'+t.name+'" title="'+s[r]+'" '+a+'  value="'+s[l]+'">'}),e.append($('<div class="'+v+'">'+i+"</div>"))},error:function(){layer.msg("checkbox server load fail")}})}(f,g)}else if("password"==x){var w=!1;if($("script").each(function(){if($(this)[0].outerHTML.indexOf("md5.js")!==-1)return w=!0,!1}),!w){var h=new YcyaLoader;h.loadFileList([getContentPath()+"/res/dep/md5/md5.js"],function(){})}g.append($('<div class="'+v+'"><input type="password" name="'+f.name+'" lay-vertype="'+verType+' " lay-verify="'+m+'" id="'+f.name+'_"></div>')),this.pwd.push(f.name)}break;case"select":var k="",M=f.cfg.count?f.cfg.count:0,C=M>0?1==M?'xm-select-radio=""':'xm-select-max="'+M+'"':"",Y=f.cfg.values?f.cfg.values.indexOf(",")===-1?[f.cfg.values]:f.cfg.values.split(","):[],_=f.cfg.search?'xm-select-search=""  xm-select-search-type="dl"':"",S=t.id+"_"+f.name,L=f.verify&&(f.verify.indexOf("required")!==-1?'lay-verify="required" lay-vertype="tips"':"");if(Y=f.cfg.data&&(Y.length<=f.cfg.data.length?Y:Y.slice(0,f.cfg.data.length)),z=f.qt?"qry_"+f.name+"_"+f.qt:f.name,f.cfg.data&&"object"==$.type(f.cfg.data))for(var P in f.cfg.data){var I=$.inArray(P,Y)!==-1?'selected="selected"':"";k+="<option value="+P+" "+I+">"+f.cfg.data[P]+"</option>"}g.append('<div  class="'+v+'"><select   name="'+z+'" id="'+S+'" '+C+'  xm-select="'+S+'"  xm-select-skin="ycya" xm-select-height="26px"  xm-select-direction="down"   '+_+" "+L+">"+k+"</select></div>"),this.selectList.push({id:S,cfg:f.cfg}),this.selectMap[S]=f.cfg.url?f.cfg:f.cfg.data;break;case"textarea":var T=f.qt?"":'lay-verType="'+verType+'"',z=f.qt?"qry_"+f.name+"_"+f.qt:f.name;g.append($('<div class="'+v+'"><textarea name="'+z+'" '+T+' lay-verify="'+m+'"></textarea></div>'));break;case"p":g.append($('<div class="'+v+'"><p data-name='+f.name+"></p></div>"))}r.append(g)}if(!t.isAdvanced&&t.pcfg){this.pic={};var N=void 0===t.pcfg.btns||t.pcfg.btns,A=$("<li/>",{class:"block-item layui-form-item"}),j=$("<label/>",{text:"图片信息:"}),q=$("<li/>",{class:"block-item layui-form-item"}),E=$("<div/>",{class:"yy-m-form-picview-wrap"}),R=$("<div/>",{class:"yy-m-form-picview"}),W=$("<a/>",{class:t.pcfg.auto?"layui-btn  layui-btn-sm":"layui-btn layui-btn-normal  layui-btn-sm",id:"ycya-up-btn1",text:t.pcfg.auto?"图片上传":"选择图片"});if(E.css({marginTop:"-32px"}).append(R),N&&A.append(W),q.append(j).append(E),"boolean"===$.type(t.pcfg.auto)&&!t.pcfg.auto){var F=$("<a/>",{class:"layui-btn  layui-btn-sm",id:"ycya-up-btn2",text:"开始上传"});F.css({marginLeft:5}),N&&A.append(F)}N&&r.append(A),r.append(q)}if(t.filter||t.isAdvanced){var D=$("<ul/>",{class:"yy-m-aq-btns"});t.isAdvanced&&D.css({display:"block"}),D.append('<li class="block-item layui-form-item btn-group" ><a lay-filter="'+t.filter+'" lay-submit id="ycyaAqYes" class="ycyaAqYes">确定</a><a class="white" id="ycyaAqNo">取消</a></li>')}if(t.map&&t.map.btns){this.popupPara={btnToAdmin:"_ycyaMapDraw"};var Q=$("<li/>",{class:"block-item"}),B=$("<div/>",{class:"m-inline-block w-all",id:this.popupPara.btnToAdmin}),O=$("<button/>",{class:"layui-btn layui-btn-sm layui-btn-normal",text:"绘制",click:function(){var i=$("[name="+t.map.btnToElm+"]","#"+t.id).val(),a=t.map.btnElmJson[i];e.points?layer.msg("已绘制，请选择重汇"):a&&e.drawRail(a)}}),H=$("<button/>",{class:"layui-btn layui-btn-sm layui-btn-warm",text:"重汇",click:function(){var i=$("[name="+t.map.btnToElm+"]","#"+t.id).val(),a=t.map.btnElmJson[i]||"circle";e.points?(e.points="",e.map&&e.map.clear(),a&&e.drawRail(a)):layer.msg("未绘制，请先绘制")}});O.css("padding","0 15px"),H.css("padding","0 15px"),B.append(O).append(H),Q.append(B),r.append(Q)}if($("#"+t.id).append(r).append(D),s&&$("#"+t.id).append(s),!t.isAdvanced&&t.pcfg&&(this.preview=$(".yy-m-form-picview","#"+t.id)),!t.isAdvanced&&t.pcfg){var V={elem:$("#ycya-up-btn1","#"+t.id),choose:function(i){if(t.pcfg.multiple||(t.pcfg.multiple=!0),t.pcfg.multiple){e.files=i.pushFile();var a=function(){var t=0;for(var i in e.files)t++;return t}();if(t.pcfg.max&&a>t.pcfg.max)return layer.alert("不能超过"+t.pcfg.max+"张图片",{icon:5}),delete e.files[Object.keys(e.files)[Object.keys(e.files).length-1]],!1;i.preview(function(i,a,s){$(".yy-m-form-picview","#"+t.id).append('<span><img src="'+s+'" alt="'+a.name+'" class="layui-upload-img"><i class="layui-icon">&#x1006;</i></span>'),$(".yy-m-form-picview i","#"+t.id).off("click"),$(".yy-m-form-picview i","#"+t.id).click(function(){var t=$(this).siblings("img").attr("alt");for(var i in e.files)e.files[i].name===t&&delete e.files[i];for(var i in e.pic)i===t&&delete e.pic[i];$(this).parent().remove()})})}else i.preview(function(e,i,a){$(".yy-m-form-picview","#"+t.id).html('<span><img src="'+a+'" alt="'+i.name+'" class="layui-upload-img"><i class="layui-icon">&#x1006;</i></span>')})},done:function(t){return t.code>0?layer.msg("上传失败,请重新上传"):void(e.pic[t.data[0].oldName]=t.data[0].uuid)}};t.pcfg.multiple&&!t.pcfg.auto&&(V.bindAction=$("#ycya-up-btn2","#"+t.id)),$.extend(!0,t.pcfg,V),this.upload=new Yupload(t.pcfg)}if(this.eventName.length>0&&this.eventName.length===this.eventFn.length)for(var P=0;P<this.bindElm.length;P++)(function(i){"tree"===e.eventName[i]?(e.id.push(e.bindElm[i]),$("#"+t.id).on("click",'[name="'+e.bindElm[i]+'"]',function(){e.tree($.extend(e.cfgFn[i],{elm:$(this)}))})):"address"===e.eventName[i]?(e.address.push(e.bindElm[i]),$("#"+t.id).on("click",'[name="'+e.bindElm[i]+'"]',function(){e.getPlace($.extend(e.cfgFn[i],{elm:$(this)}))})):$("#"+t.id).on(e.eventName[i],'[name="'+e.bindElm[i]+'"]',function(){e.eventFn[i]&&e.eventFn[i]()})})(P);if(this.dateList.length>0)for(var K=layui.laydate,p=0;p<this.dateList.length;p++)if("array"==$.type(this.dateList[p]))for(var Z=0;Z<this.dateList[p].length;Z++){var G={elem:"#"+e._cfg.id+' [name="'+this.dateList[p][Z]+'"]'};$.extend(G,this.dateCfgList[p][Z]),K.render(G)}else{var G={elem:"#"+e._cfg.id+' [name="'+this.dateList[p]+'"]'};$.extend(G,this.dateCfgList[p]),K.render(G)}var J=layui.form;if(J.render(),this.selectList.length>0){var U=layui.formSelects;$.each(this.selectList,function(t,e){if(e.cfg&&e.cfg.url){var i=$.extend(!0,{},app.ui.formSelectsCfg,{type:e.cfg.type||"post",searchUrl:e.cfg.url}),a=$.extend(!0,i,e.cfg.cfg);U.data(e.id,"server",a)}else U.render(e.id)})}t.map&&t.map.admin&&(this.createAdmin(),layui.formSelects.on(t.id+"_"+t.map.btnToElm,function(i,a,s,n,r){s.val==t.map.btnToVal?($("button","#"+e.popupPara.btnToAdmin).each(function(){$(this).hide()}),e.openAdmin()):$("button","#"+e.popupPara.btnToAdmin).each(function(){$(this).show()})},!1)),t.filter&&J.on("submit("+t.filter+")",function(i){if(t.pcfg){var a=e.upload.cfg.file?e.upload.cfg.file:"file";delete i.field[a]}if(t.pcfg){if(t.pcfg.required&&0==Object.keys(e.pic).length)return layer.msg("请上传图片");var s=[];for(var n in e.pic)s.push(e.pic[n]);i.field[t.pcfg.picName||"pic"]=s.join(",")}if(t.map&&t.map.admin){if(!e.points)return layer.msg("请绘制区域",{time:2e3});i.field[t.map.admin.pointList||"pointList"]=e.points}if(e.cirCenter&&e.cirRadius&&(i.field[t.map.admin.circleRadius||"circleRadius"]=e.cirRadius,i.field[t.map.admin.cirCenter||"cirCenter"]=e.cirCenter),e.switchList.length>0){var r=$(i.elem).parent().parent().siblings("ul");$.each(e.switchList,function(t,e){var a=r.find("[name="+e+"]"),s=a.siblings("div").find("em").text();i.field[e]=a.attr("data-value")[a.attr("lay-text").indexOf(s)]})}if(e.checkList.length>0&&$.each(e.checkList,function(t,a){for(var s=a.name,n=$("[name="+s+"] + .layui-form-checkbox","#"+e._cfg.id),r=$("[name="+s+"]","#"+e._cfg.id),l=[],o=0,c=n.length;o<c;o++)$(n[o]).hasClass("layui-form-checked")&&l.push($(r[o]).attr("value"));i.field[s]=l.toString()}),"function"==$.type(t.submitFn)){if(e.id.length>0)for(var l=0;l<e.id.length;l++){var o=e.id[l];i.field[o]=$("#"+t.id+' [name="'+e.id[l]+'"]').attr("keyid")}var c=$("#"+e._cfg.id).find("input,select,textarea");if($.each(c,function(t,e){var a=$(this).attr("keyid");a&&(i.field[$(this).attr("name")]=a)}),e.address.length>0)for(var l=0;l<e.address.length;l++){var o=e.address[l];i.field.lng=$("#"+t.id+' [name="'+o+'"]').attr("data-lng"),i.field.lat=$("#"+t.id+' [name="'+o+'"]').attr("data-lat")}if(e.pwd.length>0)for(var l=0;l<e.pwd.length;l++){var o=e.pwd[l];""!=$.trim($("#"+t.id+' [name="'+o+'"]').val())&&(i.field[o]=hex_md5($("#"+t.id+' [name="'+o+'"]').val()))}t.allowEmpty||$.each(i.field,function(t,e){e||delete i.field[t]}),t.submitFn(i.field)}}),$("#ycyaAqNo","#"+t.id).click(function(){t.isAdvanced?$("#"+t.id).hide(400):void 0!==t.index&&e.close()}),t.callback&&"function"==$.type(t.callback)&&t.callback(this)},reset:function(){var t=this;if($("input","#"+this._cfg.id).each(function(){var t=$(this).attr("type");"text"!=t&&"password"!=t||$(this).val("").removeAttr("keyid").removeAttr("data-lng").removeAttr("data-lat")}),this.selectList.length>0&&$.each(this.selectList,function(t,e){var i=[];e.cfg.values&&(i=e.cfg.values.indexOf(",")!==-1?e.cfg.values.split(","):[e.cfg.values-0]),layui.formSelects.value(e.id,i),$("input","[fs_id="+e.id+"]").removeClass("layui-form-danger")}),this.radioList.length>0&&($.each(this.radioList,function(e,i){for(var a=$("[name="+i.name+"]","#"+t._cfg.id),s=0,n=a.length;s<n;s++){var r=$(a[s]);r.prop("checked",r.attr("value")==i.checked)}}),layui.form.render("radio")),this.checkList.length>0&&($.each(this.checkList,function(e,i){var a=$("[name="+i.name+"]","#"+t._cfg.id);if(!i.checked)for(var s=0,n=a.length;s<n;s++)$(a[s]).prop("checked",!1);for(var s=0,n=a.length;s<n;s++)$(a[s]).prop("checked",$.inArray($(a[s]).attr("value"),i.checked)!=-1)}),layui.form.render("checkbox")),$("textarea","#"+this._cfg.id).each(function(){$(this).val("")}),this._cfg.pcfg&&this.preview){if(this.preview.html(""),this.files)for(var e in this.files)delete this.files[e];if(this.pic)for(var e in this.pic)delete this.pic[e]}this.map&&this.map.clear(),this.points&&(this.points="",this.cirRadius="",this.cirCenter=""),this.adminName&&(this.adminName=""),this.popupPara&&$("#"+this.popupPara.btnToAdmin).length>0&&$("button","#"+this.popupPara.btnToAdmin).each(function(){$(this).show()})},set:function(t,e,i,a,s){var n=this;if("object"===$.type(t)&&!$.isEmptyObject(t)){if(0==$("ul.yy-m-aq-btns","#"+this._cfg.id).length)return void $("p","#"+this._cfg.id).each(function(){var e=$(this).attr("data-name");$(this).text(void 0!==t[e]?t[e]:"--")});if($("input","#"+this._cfg.id).each(function(){var e=$(this).attr("type"),i=$(this).attr("name");"text"!=e&&"password"!=e||$(this).val(t[i]?t[i]:"")}),"object"===$.type(s)&&$.each(s,function(e,i){if("selLinkage"==e)for(var a=0;a<i.length;a++){var s=i[a].name,r=n._cfg.id+"_"+s,l=n.selectMap[r]||{},o=$.extend(!0,{},app.ui.formSelectsCfg,{type:"post",searchUrl:!$.isEmptyObject(l)&&l.url});formCfg=$.extend(!0,o,!$.isEmptyObject(l)&&l.cfg),$.each(i[a].data,function(t,e){formCfg.data[t]=e}),layui.formSelects.data(r,"server",formCfg)}$("#"+n.mapId).length>0&&n._cfg.map.admin&&("admin"==e&&i?$("button","#"+n.popupPara.btnToAdmin).each(function(){$(this).hide()}):(n.map=app.ui.map.init({id:n.mapId}),n.map.ready(function(){if(("points"==e||"cirRadius"==e||"cirCenter"==e)&&(n[e]=t[i],"points"==e&&n[e])){if(","==n[e][n[e].length-1])var a=n[e].slice(0,n[e].length-2);for(var s=a?a.split(","):n[e].split(","),r=[],l=0;l<s.length;l+=2)r.push(n.map.createPoint(s[l],s[l+1]));setTimeout(function(){n.map.createOverlay(r,"line2")},500)}})))}),this.selectList.length>0&&$.each(this.selectList,function(e,i){var a=i.id.split("_")[1],s=t[a],n=[];if(void 0!==s){if(s="string"===$.type(s)?s:s+"",s.indexOf(",")===-1)n.push(s);else{var n=[];$.each(s.split(","),function(t,e){n.push(e)})}layui.formSelects.value(i.id,n),$("input","[fs_id="+i.id+"]").removeClass("layui-form-danger")}}),this.switchList.length>0&&$.each(this.switchList,function(e,i){var a=1==t[i];$("[name="+i+"]","#"+n._cfg.id).prop("checked",a)}),this.radioList.length>0&&$.each(this.radioList,function(e,i){for(var a=$("[name="+i.name+"]","#"+n._cfg.id),s=0,r=a.length;s<r;s++){var l=$(a[s]);l.prop("checked",l.attr("value")==t[i.name])}}),this.checkList.length>0&&$.each(this.checkList,function(e,i){for(var a=$("[name="+i.name+"]","#"+n._cfg.id),s=0,r=a.length;s<r;s++){var l=$(a[s]),o=t[i.name],c=void 0!==o&&(o.indexOf(",")!=-1?o.split(","):[o]);l.prop("checked",$.inArray(l.attr("value"),c)!=-1)}}),$("textarea","#"+this._cfg.id).each(function(){var e=$(this).attr("name");$(this).val(t[e]?t[e]:"")}),e&&"array"===$.type(e)&&e.length>0)for(var r=0;r<e.length;r++)$("#"+this._cfg.id+" [name="+e[r]+"]").attr("keyid",t[e[r]]);if(i&&"array"===$.type(i)&&2==i.length)for(var r=0;r<this.address.length;r++)$("#"+this._cfg.id+" [name="+this.address[r]+"]").attr("data-lng",t[i[0]]).attr("data-lat",t[i[1]]);if(a){var l=[],n=this;if(this._cfg.pcfg){if(this.files)for(var o in this.files)delete this.files[o];if(this.pic)for(var o in this.pic)delete this.pic[o]}if(this.pic&&this.preview&&""!=t[a]&&"0"!=t[a]){if(t[a].indexOf(",")===-1)l.push('<span><img src="'+app.url+"file/view?id="+t[a]+'" class="layui-upload-img"><i class="layui-icon mod-img" data-id='+t[a]+">&#x1006;</i></span>"),this.pic={0:t[a]},this.files={0:t[a]};else{var c=t[a].split(","),l=[];this.files={};for(var r=0,d=c.length;r<d;r++)l.push('<span><img src="'+app.url+"file/view?id="+c[r]+'" class="layui-upload-img"><i class="layui-icon mod-img" data-id='+c[r]+">&#x1006;</i></span>"),this.pic[r]=c[r],this.files[r]=c[r]}this.preview.html(l.join("")),$(".yy-m-form-picview i.mod-img","#"+this._cfg.id).off("click"),$(".yy-m-form-picview i.mod-img","#"+this._cfg.id).click(function(){var t=$(this).attr("data-id");for(var e in n.files)n.files[e]===t&&delete n.files[e];for(var e in n.pic)n.pic[e]===t&&delete n.pic[e];$(this).parent().remove()})}}layui.form.render()}},aliasSet:function(t,e){if("object"!==$.type(t))return layer.msg("aliasSet para error");var i=this;return 0==$("ul.yy-m-aq-btns","#"+this._cfg.id).length?void $.each(e,function(e,a){if("direct"!==e){var s=$("[data-name="+e+"]","#"+i._cfg.id);s.length>0&&s.text(t[a])}else $.each(a,function(t,e){var a=$("[data-name="+t+"]","#"+i._cfg.id);a.length>0&&a.text(e)})}):void $.each(e,function(e,a){var s=$("[name="+e+"]","#"+i._cfg.id);s.length>0&&s.val(t[a])})},disabled:function(t,e){var e=void 0!==e&&e,i=this;$.each(t,function(t,a){var s=$("[name="+a+"]","#"+i._cfg.id);s.length>0&&s.prop("disabled",!!e)})},selDisabled:function(t){var e=this;$.each(t,function(t,i){var a=!!i;a?layui.formSelects.disabled(e._cfg.id+"_"+t):layui.formSelects.undisabled(e._cfg.id+"_"+t)})},close:function(){this._cfg.index&&(layer.close(this._cfg.index),$("#"+this._cfg.id).hide())},popup:function(t){var e=[],i={},a=this;if(layui.form.render(),t&&t.btns);else{var t=t?t:{};t.btns=[{title:"确定",handle:"",yes:!0},{title:"取消",handle:""}]}if(1==t.btns.length)e.push(t.btns[0].title),t.btns[0].handle?i.yes=t.btns[0].handle:i.yes=function(){a.close()};else if(t.btns.length>1)for(var s=0;s<t.btns.length;s++)e.push(t.btns[s].title),t.btns[s].yes||(t.btns[s].handle?i["btn"+(s+1)]=t.btns[s].handle:i["btn"+(s+1)]=function(){a.close()});var n=t.width||500;n=n<300?300:n;var r={type:1,area:n+"px",maxmin:t.maxmin||!1,title:t.title||"表单信息",content:$("#"+this._cfg.id),btn:e,anim:app.ui.anim,success:function(e,i){t.height&&$(".yy-m-aq-popup","#"+this._cfg.id).height(t.height),t.success&&t.success()},yes:function(t,e){e.find("#"+a._cfg.id+" .ycyaAqYes").click()},end:function(){$("#"+a._cfg.id).hide(),t.end&&t.end()}},l=t.height||$("#"+this._cfg.id).height()+40+43+2,o=$(window).height();l<170&&(l=170),l>o&&(l=o-60,r.area=[n+"px",l+"px"]),t.height&&(r.area=[n+"px",t.height+"px"]),this._cfg.index=layer.open($.extend(r,i))},tree:function(t){return t&&t.url?void(this.treeIndex=layer.open({type:2,area:["500px","300px"],title:t.title||"请选择部门",content:getContentPath()+t.url,btn:["确定"],yes:function(e,i){var a=$(i).find("iframe")[0].contentWindow,s=a.getSelected();if(s.arr.length>0)if(1==s.arr.length)t.elm.val(s.arr[0][t.name]).attr("keyid",s.arr[0].id);else{for(var n=[],r=[],l=0;l<s.arr.length;l++)n.push(s.arr[l][t.name]),r.push(s.arr[l].id);t.elm.val(n.join(",")).attr("keyid",r.join(","))}layer.close(e)},end:function(){t.end&&t.end()}})):layer.msg("para error")},getPlace:function(t){return t&&t.url?void(this.treeIndex=layer.open({type:2,area:["500px","415px"],title:t.title||"地点",content:getContentPath()+t.url,btn:["确定"],yes:function(e,i){var a=$(i).find("iframe")[0].contentWindow,s=a.returnData();t.elm.val(s.name).attr("data-lng",s.lng).attr("data-lat",s.lat),layer.close(e)}})):layer.msg("para error")},createAdmin:function(){var t="ycyaMapAdmin";this.adminBoxId=t,this.adminTreeId="ycyaMapAdminTree",0==$("#"+t).length&&$("body").append('<div id="'+t+'" class="m-none"><div style="overflow-y: auto;height:300px"><ul id="'+this.adminTreeId+'" class="ztree"></ul></div></div>');var e=!1;if($("script").each(function(){if($(this)[0].outerHTML.indexOf("ztree.all.js")!==-1)return e=!0,!1}),!e){var i=new YcyaLoader;i.loadFileList([getContentPath()+"/res/dep/zTree/css/zTreeStyle/zTreeStyle.css",getContentPath()+"/res/dep/zTree/js/jquery.ztree.all.js"],function(){})}},openAdmin:function(){var t=this,e=layer.open({type:1,content:$("#"+this.adminBoxId),anim:app.ui.anim,shade:0,title:"选择行政区域",area:["400px","400px"],btn:["确定","取消"],yes:function(){if(0==t.adminTree.getSelectedNodes().length)return layer.msg("请选择行政区域",{time:1e3});var i,a=t.adminTree.getSelectedNodes()[0],s=a.getParentNode();if(a){if(s)if(s.name.indexOf("城区")>=0||s.name.indexOf("郊县")>=0){var n=s.getParentNode();i=n.name+a.name}else i=s.name+a.name;else i=a.name;t.adminName=i,t.map.getBoundary(i,function(i){t.map.clear();var a=i.boundaries.length;if(0===a)return layer.msg("未能获取当前输入行政区域");for(var s=[],n=0;n<a;n++){var r=new BMap.Polygon(i.boundaries[n],{strokeWeight:2,strokeColor:"#ff0000"});s=s.concat(r.getPath()),t.points="",$.each(r.getPath(),function(e,i){t.points+=i.lng+","+i.lat+","})}t.map.createOverlay(s,"line2"),layer.close(e)})}},success:function(){var e={data:{key:{name:"name"},simpleData:{enable:!0,pIdKey:"pid"}},view:{showIcon:!0},callback:{onClick:function(e,i,a){var s=t.adminTreeData;if(!(a.check_Child_State>=0)&&void 0!=s){if(0==a.level)for(var n in s)if(s[n].adcode==a.adcode){var r=s[n].districts;t.adminTree.addNodes(a,r),cityRows=r}if(1==a.level){var l,o,c=a.getParentNode();for(var n in s)if(s[n].adcode==c.adcode){l=s[n].districts;for(var d in l)a.adcode==l[d].adcode&&(o=l[d].districts,t.adminTree.addNodes(a,o),cityRows=r)}}}}}};$.ajax({url:"http://restapi.amap.com/v3/config/district?key=a1c3be6735ea724d2de25e3b3a0fbd15&subdistrict=3&extensions=base",type:"GET",success:function(i){1==i.status&&(t.adminTreeData=i.districts[0].districts,t.adminTree=$.fn.zTree.init($("#"+t.adminTreeId),e,t.adminTreeData))}})},end:function(){$("#"+t.adminBoxId).hide()}})},drawRail:function(t){var e=this;e.map.draw({line:"line2",flag:t},function(i,a){var s=i.overlay.getPath();e.points="";for(var n=0;n<s.length;n++){var r=s[n];e.points+=r.lng+","+r.lat+","}"circle"==t?(e.cirCenter=i.overlay.getCenter().lng+","+i.overlay.getCenter().lat,e.cirRadius=Math.floor(i.overlay.getRadius())):(e.cirCenter="",e.cirRadius="")})},selLinkage:function(t){layui.formSelects.on(t.clickSel,function(e,i,a,s,n){var r,l=[],o=void 0!==t.count?t.count:0,c=t.cfg,d=t.keyName?t.keyName:"id";1===o?c.data[d]=a.val:(s?r=i.concat(a):($.each(i,function(t,e){if(e.val===a.val)return i.splice(t,1),!1}),r=i),$.each(r,function(t,e){l.push(e.val)}),c.data[d]=l.join(","));var h=$.extend(!0,{},app.ui.formSelectsCfg,{type:t.type||"post",searchUrl:t.url}),p=$.extend(!0,h,c);layui.formSelects.data(t.linkSel,"server",p)},!0)},selectRender:function(t){var e=$.extend(!0,{},app.ui.formSelectsCfg,{type:t.type||"post",searchUrl:t.url}),i=$.extend(!0,e,t);layui.formSelects.data(t.id,"server",i)}},t.autoform=function(t){return new e(t)}}(app.ui),app.ui.util={cssMerge:function(t,e){if(t.css){var i=[];for(var a in t.css)$.inArray(t.css[a],e)>=0&&i.push(a);for(var a=i.length-1;a>=0;a--)t.css.splice(a,1);return e.concat(t.css)}return e},btnRender:function(t,e,i,a){for(var s=0;s<t.length;s++){var n=app.ui.util.cssMerge(t[s],i),r=a+t[s].name,l='<button class="'+n.join(" ")+'" id="'+r+'">'+t[s].title+"</button>";if($(".layui-btn-group",e).append(l),t[s].handle){var o=t[s].handle;$("#"+r,e).bind("click",o)}}}},app.ui.form={_cfg:{win:null},init:function(t){var e=[],i={};if(t.btns)for(var a=0;a<t.btns.length&&t.btns[a].handle;a++)e.push(t.btns[a].title),0==a?i.yes=t.btns[a].handle:i["btn"+(a+2)]=t.btns[a].handle;var s=38*t.data.items.length+100,n=$(window).height()-40;s=s>n?n:s;var r=this;return layer.open($.extend({type:2,area:["500px",s+"px"],title:t.title||"表单信息",content:getContentPath()+t.url,btn:e,anim:app.ui.anim,success:function(e,i){var a=window[e.find("iframe")[0].name];if(r._cfg.win=a,a.setData)a.setData(t.data);else var s=setInterval(function(){a.setData&&(clearInterval(s),a.setData(t.data))},1e3)}},i)),this},initForm:function(){},setData:function(t){return this._cfg.win.setData(t)}},app.ui.search={_cfg:{id:"",listStyle:"list",allowEmpty:!1,items:[]},init:function(t,e){$.extend(this._cfg,t);var i=e?e.dom:$("#yui-search");$(".yy-m-search-title",i).html(this._cfg.title);for(var a=this._cfg.items,s={},n=a.length-1;n>=0;n--){var r,l=a[n];r="sel"==l.dt?new Yselect(l,i):new YInput(i,l),s[l.name]=r}this.fields=s;var o=this._cfg.btns;return app.ui.util.btnRender(o,i,["layui-btn","layui-btn-sm","layui-btn-primary"],"btnSearch_"),this},getValue:function(t){var e={};if(t)for(var i in t)e[t[i]]=this.fields[t[i]].getJson();else for(var a in this.fields)e[a]=this.fields[a].getJson();return e},getValueQry:function(t){var e={},i=this.getValue(t);for(var a in i)$.extend(e,i[a]);if(!this._cfg.allowEmpty)for(var a in e)null!=e[a]&&""!=e[a]||delete e[a];return e},filterEmpty:function(t){for(var e in t);}},app.ui.tree={_cfg:{data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId",rootPId:0},key:{name:"name"}},callback:{}},init:function(t){t.cfg&&$.extend(!0,this._cfg,t.cfg);var e=this._cfg,i=this;this.loaded=!1;var a=new YcyaLoader;return a.loadFileList([getContentPath()+"/res/dep/zTree/css/zTreeStyle/zTreeStyle.css",getContentPath()+"/res/dep/zTree/js/jquery.ztree.all.js"],function(){if($("#yui-tree").hasClass("ztree")||$("#yui-tree").addClass("ztree"),t.url&&""!=t.url)ycya.http.ajax(t.url,{data:t.where,type:t.type||"post",success:function(a,s,n){if(a&&0==a.code){if(t.open)for(var r=0;r<a.data.length;r++)a.data[r].open=!0;var l=$.fn.zTree.init($("#yui-tree"),e,a.data);i.tree=l,i.loaded=!0}},error:function(t,e,i){layer.msg("tree data load err:"+e)}});else{var a=$.fn.zTree.init($("#yui-tree"),e,t.data);i.tree=a,i.loaded=!0}}),this},getTree:function(){return this.tree}},app.ui.left={_cfg:{id:"",listStyle:"list",allowEmpty:!1,items:[]},init:function(t){$.extend(this._cfg,t);var e=$("#yui-left");$(".yy-m-search-title",e).html(this._cfg.title);for(var i=this._cfg.items,a={},s=i.length-1;s>=0;s--){var n=i[s],r=new YInput(e,n);a[n.name]=r}this.fields=a;var l=this._cfg.btns;l&&app.ui.util.btnRender(l,e,["layui-btn","layui-btn-sm"],"btnLeft_");var o=$(window).height()-84;$("#yui-left-nav").css("height",o+"px"),$(window).resize(function(){var t=$(window).height()-84;$("#yui-left-nav").css("height",t+"px")});var c=this,d=this._cfg.body.view,h=this._cfg.body.cfg;if("tree"==d){var p={_ref:c};$.extend(p,h);var f=app.ui.tree.init(p);this.tree=f}else"list"==d&&(h.url?(h.name||layer.msg("list para error"),ycya.http.ajax(h.url,{data:h.data||{},type:h.type||"post",success:function(t){c.list(t.data,h)}})):c.list(h.option,h));return this},getValue:function(t){var e={};if(t)for(var i in t)e[t[i]]=this.fields[t[i]].getJson();else for(var a in this.fields)e[a]=this.fields[a].getJson();return e},getValueQry:function(t){var e={},i=this.getValue(t);for(var a in i)$.extend(e,i[a]);if(!this._cfg.allowEmpty)for(var a in e)null!=e[a]&&""!=e[a]||delete e[a];return e;
},filterEmpty:function(t){for(var e in t);},list:function(t,e){var i=[];$.each(t,function(t,a){for(var s={},n=0;n<e.dataAttr.length;n++)s["data-"+e.dataAttr[n]]=a[e.dataAttr[n]];e.isCheck?s.html='<i class="layui-icon icon-ok">&#xe605;</i>'+a[e.name]:s.html=a[e.name],i.push($("<li/>",s)[0].outerHTML)}),$("#yui-tree").attr("class","yui-left-list").html(i.join("")),e.handle&&$("#yui-tree").on("click","li",function(){$(this).toggleClass("active").siblings(".active").removeClass("active"),e.handle($(this).attr("data-"+e.qry))})}},app.ui.grid={_cfg:{id:"ycyaGrid",page:!0,height:"full-104",request:{pageName:"pageNo",limitName:"pageSize"},text:{none:"暂无相关数据"},limit:20,limits:[10,20,50],method:"post",where:{}},init:function(t){$.extend(this._cfg,t);var e=layui.table;return t.btns&&(this._cfg.done=function(){ycyaTableBtn(t.btns)}),e.render(this._cfg),this},qry:function(t,e){this._cfg.where={},$.extend(this._cfg.where||{},t);var i=layui.table,a=$.extend(!0,{},this._cfg,e);i.render(a)},rowBtn:function(t){var e=app.ui.util.cssMerge(t,["layui-btn","layui-btn-xs"]);return'<a class="'+e.join(" ")+'" lay-event="'+t.event+'">'+t.title+"</a>"},getRows:function(t){if(!t)return layui.table.checkStatus(this._cfg.id);var e=[];return $.each(layui.table.checkStatus(this._cfg.id).data,function(t,i){i.id&&e.push(i.id)}),e.join(",")},delRows:function(t){var e=layui.table.checkStatus(this._cfg.id);if(0==e.data.length)return layer.msg("请勾选要删除的数据",{time:2e3});var i=[];$.each(e.data,function(t,e){e.id&&i.push(e.id)}),layer.confirm("确定删除?",function(e){t&&t(i.join(","),e)})}},app.ui.page.list={init:function(t){return t.title&&(document.title=t.title),t.left&&(this.left=app.ui.left.init($.extend(t.left,{id:"yui-left"}))),t.search&&(this.search=app.ui.search.init($.extend(t.search,{id:"yui-search"}))),t.grid&&(this.grid=app.ui.grid.init($.extend(t.grid,{elem:"#yui-grid"}))),this},getSearch:function(){return this.search},getGrid:function(){return this.grid},getLeft:function(){return this.left},getTree:function(){return this.left.tree.getTree()}},app.ui.selected={init:function(t){this.choosed=[];var e=$("<p/>",{height:22,text:t.title}),i=$("<div/>",{height:98}),a=$("<div/>",{id:"selectedRow",class:"yui-selected"});return i.append(e.css({lineHeight:"22px"})).append(a.css({height:76})),$("#yyGrid").prepend(i),this._box=$("#selectedRow"),this.name=t.item,this}},app.ui.selectedItem={init:function(t){if(!t||!t.sel||!t.row)return layer.msg("selectedItem para error");var e=!1;$.each(t.sel.choosed,function(i,a){if(a.id==t.row.id)return e=!0,!1}),e||t.sel._box.append(this.create(t.sel,t.row,t.sel.name))},create:function(t,e,i){var a=$("<i/>",{"data-id":e.id,click:function(){var e=this;$.each(t.choosed,function(i,a){if(a.id==$(e).attr("data-id"))return t.choosed.splice(i,1),!1}),$(this).parent().remove()}}),s=$("<span/>",{class:"item",html:e[i[0]]+"&nbsp;&nbsp;&nbsp;【"+e[i[1]]+"】"});return t.choosed.push({id:e.id}),s.append(a)}},app.ui.bindRail={open:function(t){if(!t.url)return layer.msg("url error or id error");var e=this;return layer.open({type:2,title:t.title||"绑定围栏",area:["500px","406px"],content:t.url,anim:app.ui.anim,success:function(i,a){var s=layer.getChildFrame("body",a),n=$(i).find("iframe")[0].contentWindow;n.returnGrid().qry(t.data,{url:t.gridUrl}),e.grid=n.returnGrid(),t.selected&&void 0!==t.selected.id&&$(s).find("input.dataId").val(t.selected.id),t.success&&t.success()}}),this}},app.ui.bindFalt={open:function(t){return t.url&&t.selected?void layer.open({type:2,title:t.title||"绑定设备",area:["500px","479px"],content:t.url,btn:["确定","取消"],anim:app.ui.anim,success:function(e,i){var a=layer.getChildFrame("body",i),s=$(e).find("iframe")[0].contentWindow;s.returnGrid().qry(t.data,{url:t.gridUrl}),$(a).find("input.dataId").val(t.selected.id)},yes:function(e,i){var a=$(i).find("iframe")[0].contentWindow.returnSelected(),s=[];$.each(a.choosed,function(t,e){s.push(e.id)}),t.yes&&t.yes(e,s)}}):layer.msg("url error or id error")}},app.ui.page.bindpopup={init:function(t){return this.cfg=t,t.search&&(this.search=app.ui.search.init(t.search,{dom:$("#pop-search")})),t.selected&&(this.selected=app.ui.selected.init(t.selected)),t.grid&&(this.tableGrid=app.ui.grid.init($.extend(t.grid,{height:t.selected?225:288,elem:"#pop-grid"}))),this},getGrid:function(){return this.tableGrid},getSearch:function(){return this.search},getSelected:function(){return this.selected}},app.ui.reportTitle={_cfg:{bgClass:"yy-m-report-bg-gray",fClass:"yy-m-report-c-gray",vClass:"",item:[]},elmId:[],init:function(t){var e=$.extend({},this._cfg,t);if("array"!==$.type(e.item)||0===e.item.length)return layer.msg("report para error");for(var i=e.item.length,a=1/i*100+"%",s=[],n=0;n<i;n++){var r=e.item[n],l=void 0!==r.value?r.value:0,o=r.unit?r.unit:"",c=r.vClass?r.vClass:"yy-m-report-c-blue",d="yui-report",h='<p class="yy-inline-block" style="width:'+a+'">';h+="<span>"+r.name+"</span><em class="+c+" id="+d+n+">"+l+"</em><i class="+c+">"+o+"</i></p>",this.elmId.push(d+n),s.push(h)}return $("#yui-report-title").attr("class",this._cfg.bgClass+" "+this._cfg.fClass+"  yy-m-report-title").html(s.join("")),this},set:function(t){return t&&"array"===$.type(t)?void $.each(this.elmId,function(e,i){$("#"+i).text(t[e])}):layer.msg("report set para error")}},app.ui.echarts={barlineCfg:{id:"yui-report-echart",type:"line",maxBarWidth:40,minBarWidth:12,colorList:["#ff2600","#ffc000","#00ad4e","#0073c2","#165868","#e76f00","#316194","#723761","#00b2f1","#4d6022","#4b83bf","#f9c813","#0176c0"],stbackgrond:["#fff"],datalName:[],valueJson:{},YMlegend:{lshow:!0,lalign:"center",lcolor:"#444",lorient:"horizontal",licon:"circle"},YMtitle:{tshow:!0,ttext:"",ttcolor:"#000",ttfontsize:16,tsubtext:"",tstcolor:"#333",tstfontsize:14,txalign:"left"},dataxName:[],YMTtooltip:"",YMBtooltip:"",xaxisClocr:["#333","#666","#444","#f6f6f6","#f6f6f6","#fff"],yaxisClocr:["#333","#666","#444","#f6f6f6","#f6f6f6","#fff"],YMxaxis:{xrotate:30,xaxisLine:!0,xaxisTick:!1,xsplitLine:!1,xaxisLabel:!0,xmargin:10,xsplitArea:!1},YMyaxis:{yminInterval:20,yrotate:60,yaxisLine:!0,yaxisTick:!1,ysplitLine:!1,yaxisLabel:!0,ytextStyle:"#666",yvalue:"value",ysplitArea:!1,ymargin:10,yname:""},YMsyaxis:{syshow:!1,syminInterval:40,syrotate:60,syaxisLine:!0,syaxisTick:!0,sysplitLine:!1,syaxisLabel:!0,sytextStyle:"#444",syvalue:"value",sysplitArea:!1,symargin:10,syname:""},YMtyaxis:{tyshow:!1,tyminInterval:20,tyrotate:60,tyaxisLine:!0,tyaxisTick:!1,tysplitLine:!1,tyaxisLabel:!0,tytextStyle:"#444",tyvalue:"value",tysplitArea:!1,tymargin:10,tyname:""},YMgrid:{gleft:"4%",gright:"4%",gbottom:0,gtop:"10%"},YMtoolbar:{itemSize:14,toorshow:!0,magicType:!0,restore:!0,saveAsImage:!0,dataView:!0,type:["line","bar","stack","tiled"]},YMdataZoom:{dzshow:!1,dzend:90,dzheight:26,dzfillerColor:"rgba(167,183,204,0.4)",dzbackgroundColor:"rgba(47,69,84,0)"}},barlineInit:function(t){$.extend(!0,this.barlineCfg,t);var e=this.barlineCfg,i=this;new YcyaLoader;return this.blChart=echarts.init(document.getElementById(e.id)),option={legend:{show:e.YMlegend.lshow,type:"scroll",orient:e.YMlegend.lorient,icon:e.YMlegend.licon,data:e.datalName,align:"left",x:e.YMlegend.lalign,textStyle:{color:e.YMlegend.lcolor,fontSize:14},itemWidth:20,itemHeight:10},backgroundColor:e.stbackgrond,title:{x:e.YMtitle.txalign,show:e.YMtitle.tshow,text:e.YMtitle.ttext,textStyle:{fontSize:e.YMtitle.ttfontsize,color:e.YMtitle.ttcolor},subtext:e.YMtitle.tsubtext,subtextStyle:{fontSize:e.YMtitle.tstfontsize,color:e.YMtitle.tstcolor}},color:e.colorList,tooltip:{trigger:"axis",backgroundColor:"#fff",borderWidth:1,borderColor:"#ccc",padding:10,textStyle:{color:"#000"},axisPointer:{type:"shadow"},formatter:function(t){var i=e.YMTtooltip+t[0].name+"<br/>";for(j=0;j<t.length;j++)i+=t[j].seriesName+" : "+t[j].value+"<br/>";return i+e.YMBtooltip}},toolbox:{itemSize:e.YMtoolbar.itemSize,feature:{dataView:{show:e.YMtoolbar.dataView},magicType:{show:e.YMtoolbar.magicType,type:e.YMtoolbar.type},restore:{show:e.YMtoolbar.restore},saveAsImage:{show:e.YMtoolbar.saveAsImage}}},dataZoom:[{height:e.YMdataZoom.dzheight,type:"slider",show:e.YMdataZoom.dzshow,fillerColor:e.YMdataZoom.dzfillerColor,start:0,end:e.YMdataZoom.dzend,handleSize:0,backgroundColor:e.YMdataZoom.dzbackgroundColor}],grid:{left:e.YMgrid.gleft,right:e.YMgrid.gright,bottom:e.YMgrid.gbottom,top:e.YMgrid.gtop,containLabel:!0},xAxis:[{show:!0,type:"category",data:[],axisLine:{show:e.YMxaxis.xaxisLine,lineStyle:{color:e.xaxisClocr[0],width:1,type:"solid"}},axisTick:{show:e.YMxaxis.xaxisTick,lineStyle:{color:e.xaxisClocr[1]}},axisLabel:{show:e.YMxaxis.xaxisLabel,margin:e.YMxaxis.xmargin,rotate:e.YMxaxis.xrotate,textStyle:{color:e.xaxisClocr[2]}},splitLine:{show:e.YMxaxis.xsplitLine,textStyle:{color:e.xaxisClocr[3]}},splitArea:{show:e.YMxaxis.xsplitArea,areaStyle:{color:[e.xaxisClocr[4],e.xaxisClocr[5]]}}}],yAxis:[{min:0,minInterval:e.YMyaxis.yminInterval,type:e.YMyaxis.yvalue,name:e.YMyaxis.yname,axisLabel:{margin:e.YMyaxis.ymargin,rotate:e.YMyaxis.yrotate,textStyle:{color:e.yaxisClocr[0]}},axisTick:{show:e.YMyaxis.yaxisTick,lineStyle:{color:e.yaxisClocr[1]}},axisLine:{show:e.YMyaxis.yaxisLine,lineStyle:{color:e.yaxisClocr[2]}},splitLine:{show:e.YMyaxis.ysplitLine,lineStyle:{color:e.yaxisClocr[3]}},splitArea:{show:e.YMyaxis.ysplitArea,areaStyle:{color:[e.yaxisClocr[4],e.yaxisClocr[5]]}}},{show:e.YMsyaxis.syshow,name:e.YMsyaxis.syname,min:0,minInterval:e.YMsyaxis.syminInterval,type:e.YMsyaxis.syvalue,position:"right",axisLabel:{margin:e.YMsyaxis.symargin,rotate:e.YMsyaxis.syrotate,textStyle:{color:e.yaxisClocr[0]}},axisTick:{show:e.YMsyaxis.syaxisTick,lineStyle:{color:e.yaxisClocr[1]}},axisLine:{show:e.YMsyaxis.syaxisLine,lineStyle:{color:e.yaxisClocr[2]}},splitLine:{show:e.YMsyaxis.sysplitLine,lineStyle:{color:e.yaxisClocr[3]}},splitArea:{show:e.YMsyaxis.sysplitArea,areaStyle:{color:[e.yaxisClocr[4],e.yaxisClocr[5]]}}}],series:[]},this.blChart.setOption(option),this.blChart.showLoading(),$(window).resize(function(){i.blChart.resize()}).resize(),this},barlineSet:function(t,e){var i=this.barlineCfg;for(var a in e)i.datalName.push(a);var s,n=[],r=$("body").width()*(1-parseInt(i.YMgrid.gleft)/100-parseInt(i.YMgrid.gright)/100),l=r/t.length,o=(l-40)/i.datalName.length,c=Math.ceil(1.3*i.minBarWidth)*i.datalName.length,d=parseInt(r/c);s=t.length>d?100-(t.length-d+1)/t.length*100:100;for(var h=0;h<i.datalName.length;h++){var p={name:i.datalName[h],type:i.type,data:e[i.datalName[h]]};o<i.minBarWidth?p.barWidth=i.minBarWidth:o>i.maxBarWidth&&(p.barWidth=i.maxBarWidth),n.push(p)}var f={xAxis:[{data:t}],dataZoom:[{show:i.YMdataZoom.dzshow,end:i.YMdataZoom.dzend}],series:n};c>l&&(f.dataZoom[0].show=!0,f.dataZoom[0].end=s),this.blChart.setOption(f),this.blChart.hideLoading()},pieCfg:{id:"yui-report-echart",valueJson:[],YMPcolorList:["#ffc000","#00ad4e","#0073c2","#165868","#e76f00","#316194","#723761","#00b2f1","#4d6022","#4b83bf","#f9c813","#0176c0"],YMPstbackgrond:["#fff"],YMPlegend:{lshow:!0,lalign:"center",lcolor:"#444",lorient:"vertical",licon:"circle",ldata:[],lyalign:"center"},YMPtitle:{tshow:!0,ttext:"",ttcolor:"#444",ttfontsize:16,tsubtext:"",tstcolor:"#666",tstfontsize:14,txalign:"left"},YMPtotaltitle:{totalshow:!1,totalnshow:!1,totaltext:"",totaltextsize:14,totalnumber:"",totalnumbersize:26,totalColor:["#999","#333"]},YMPtooltip:{YMPTtooltip:"",YMPBtooltip:"",YMPcontent:"{b}:{c}({d}%)"},YMPseries:{sname:"",sradius:["0%","70%"],slabelshow:!1,sastyle:["","16"],sbstyle:["","14"],scstyle:["","18"],scontent:"{a}{c}{a|{d}%}\n{b|{b}}"},YMPtoolbar:{itemSize:14,toorshow:!0,restore:!0,saveAsImage:!0,dataView:!0}},pieInit:function(t){var e=this;$.extend(!0,this.pieCfg,t);var i=this.pieCfg;this.pieChart=echarts.init(document.getElementById(i.id));var a={color:i.YMPcolorList,legend:{show:i.YMPlegend.lshow,type:"scroll",orient:i.YMPlegend.lorient,icon:i.YMPlegend.licon,data:i.YMPlegend.ldata,align:"left",x:i.YMPlegend.lalign,y:i.YMPlegend.lyalign,textStyle:{color:i.YMPlegend.lcolor,fontSize:14},itemWidth:20,itemHeight:10},backgroundColor:i.YMPstbackgrond,title:[{show:i.YMPtitle.tshow,x:i.YMPtitle.txalign,text:i.YMPtitle.ttext,textStyle:{fontSize:i.YMPtitle.ttfontsize,color:i.YMPtitle.ttcolor},subtext:i.YMPtitle.tsubtext,subtextStyle:{fontSize:i.YMPtitle.tstfontsize,color:i.YMPtitle.tstcolor}},{show:i.YMPtotaltitle.totalshow,text:i.YMPtotaltitle.totaltext,left:"49%",top:"46%",textAlign:"center",textBaseline:"middle",textStyle:{color:i.YMPtotaltitle.totalColor[0],fontWeight:"normal",fontSize:i.YMPtotaltitle.totaltextsize}},{show:i.YMPtotaltitle.totalnshow,text:i.YMPtotaltitle.totalnumber,left:"49%",top:"51%",textAlign:"center",textBaseline:"middle",textStyle:{color:i.YMPtotaltitle.totalColor[1],fontWeight:"normal",fontSize:i.YMPtotaltitle.totalnumbersize}}],tooltip:{trigger:"axis",backgroundColor:"#fff",borderWidth:1,borderColor:"#ccc",padding:10,textStyle:{color:"#000"},axisPointer:{type:"shadow"},trigger:"item",formatter:i.YMPtooltip.YMPTtooltip+i.YMPtooltip.YMPcontent+i.YMPtooltip.YMPBtooltip},toolbox:{itemSize:i.YMPtoolbar.itemSize,feature:{dataView:{show:i.YMPtoolbar.dataView},restore:{show:i.YMPtoolbar.restore},saveAsImage:{show:i.YMPtoolbar.saveAsImage}}},series:[{name:i.YMPseries.sname,type:"pie",radius:i.YMPseries.sradius,labelLine:{normal:{length:20,length2:80,lineStyle:{color:"#333"}}},label:{normal:{show:i.YMPseries.slabelshow,formatter:i.YMPseries.scontent,borderWidth:0,borderRadius:4,padding:[0,12],textStyle:{color:i.YMPseries.scstyle[0],fontSize:i.YMPseries.scstyle[1]},rich:{a:{color:i.YMPseries.sastyle[0],fontSize:i.YMPseries.sastyle[1],padding:[0,0,0,6]},b:{fontSize:i.YMPseries.sbstyle[1],padding:4,color:i.YMPseries.sbstyle[0]}}}},data:[]}]};return this.pieChart.setOption(a),this.pieChart.showLoading(),$(window).resize(function(){e.pieChart.resize()}).resize(),this},pieSet:function(t){var e=this.pieCfg,i=[];for(var a in t)i.push(t[a].name);this.pieChart.setOption({legend:{data:i},series:[{name:e.YMPseries.sname,type:"pie",radius:e.YMPseries.sradius,labelLine:{normal:{length:20,length2:80,lineStyle:{color:"#333"}}},label:{normal:{show:e.YMPseries.slabelshow,formatter:e.YMPseries.scontent,borderWidth:0,borderRadius:4,padding:[0,12],textStyle:{color:e.YMPseries.scstyle[0],fontSize:e.YMPseries.scstyle[1]},rich:{a:{color:e.YMPseries.sastyle[0],fontSize:e.YMPseries.sastyle[1],padding:[0,0,0,6]},b:{fontSize:e.YMPseries.sbstyle[1],padding:4,color:e.YMPseries.sbstyle[0]}}}},data:t}]}),this.pieChart.hideLoading()}},app.ui.reportSearch={_cfg:{yearNum:2,quickQuery:[{name:"月统计数据",handle:function(){}},{name:"年统计数据",handle:function(){}}],allowEmpty:!1,item:[],ready:function(){},conditionQuery:{show:!0,iconClass:""},isQry:!0,yearQuery:!0,yearQueryBack:!0,monthQuery:!0,start:"00:00:00",end:"23:59:59",refreshFn:function(t){}},init:function(t){t&&$.extend(!0,this._cfg,t);for(var e=this._cfg,i=$('<div class="yy-m-report-search"></div>'),a=$('<ul class="yy-m-report-quickQuery yy-lf"></ul>'),s=$('<ul class="yy-m-report-customQuery yy-lf"></ul>'),n=0;n<e.quickQuery.length;n++)a.append($('<li class="yy-lf">'+e.quickQuery[n].name+'</li><li class="line"></li>'));if(s.append($('<li class="yy-lf">自定义查询</li><li class="line yy-lf"></li>')),i.append(a).append(s),e.yearQuery){var r=$('<ul class="yy-m-report-yearQuery yy-lf"></ul>'),l=(new Date).getFullYear();if(this.activeY=l,e.yearQueryBack)for(var n=e.yearNum-1;n>=0;n--){var o=0===n?["yy-lf","active"]:["yy-lf"];r.append($('<li class="'+o.join(" ")+'">'+(l-n)+"</li>"))}else for(var n=0;n<e.yearNum;n++){var o=0===n?["yy-lf","active"]:["yy-lf"];r.append($('<li class="'+o.join(" ")+'">'+(l+n)+"</li>"))}i.append(r)}if(e.monthQuery){var c=$('<ul class="yy-m-report-monthQuery yy-lf"></ul>'),d=(new Date).getMonth()+1;this.activeM=d<10?"0"+d:d;for(var n=1;n<13;n++){var o=n===d?["yy-lf","active"]:["yy-lf"];c.append($('<li class="'+o.join(" ")+'">'+n+"</li>"))}i.append(c)}if(e.conditionQuery.show){var h=$('<ul class="yy-m-report-conditionQuery yy-rt"></ul>'),p=$("<li>条件查询</li>");e.conditionQuery.iconClass&&p.append($("<span class="+iconClass+"></span>")),h.append(p),i.append(h)}return $("#yui-report-search").append(i),this.condition=$(".yy-m-report-conditionQuery>li"),this.quick=$(".yy-m-report-quickQuery>li"),this.custom=$(".yy-m-report-customQuery>li"),e.yearQuery&&(this.year=$(".yy-m-report-yearQuery>li"),this.yearHandler()),e.monthQuery&&(this.month=$(".yy-m-report-monthQuery>li"),this.monthHandler()),t.quickQuery||this.quickHandler(),this.customHandler(),this.conditionHandler(),this.formInit(),this},formInit:function(){this.searchItem=$("#yui-report-search-list");for(var t=this,e=this._cfg.item,i=this.searchItem,a={},s=e.length-1;s>=0;s--){var n=e[s],r=n.type||"input";if("input"===r)a[n.name]=new YInput(i,n),"btw"==n.qt&&(t.timeArr=["qry_"+n.name+"_gt","qry_"+n.name+"_lt"]);else{var l=$("<div/>",{class:"yy-m-search-item"}),o=$("<label>"+n.label+"</label>"),c=$("<select/>",{id:"qry_"+n.name+"_in",class:"layui-select"});if(l.append(o),n.cfg&&function(t){ycya.http.ajax(t.cfg.url,{type:t.cfg.type||"post",data:t.cfg.where,success:function(e){var i=t.cfg.beforeSuccess?t.cfg.beforeSuccess(e):e.data,a=t.cfg.keyName?t.cfg.keyName:"name",s=t.cfg.valName?t.cfg.valName:"id";for(var n in i)c.append($("<option value="+i[n][s]+">"+i[n][a]+"</option>"))}})}(n),n.option&&!n.cfg)for(var d in n.option)c.append($("<option value="+d+">"+n.option[d]+"</option>"));l.append(c),a[n.name]=c,$(".yy-m-search",i).append(l)}}this.fields=a,$(".yy-m-search",i).append($("<button/>",{class:"layui-btn layui-btn-sm layui-btn-normal",text:"确定",click:function(){var e=!1;if(t.timeArr&&(""!=$.trim($("#"+t.timeArr[0]).val())&&""!=$.trim($("#"+t.timeArr[1]).val())||(e=!0,layer.msg("请选择时间段",{time:2e3}))),!e){var i=t.getValue();t.request(t._cfg.refreshFn,i)}}})),this._cfg.ready()},formReset:function(){if(this.ids=this.ids||[],0==this.ids.length)for(var t in this.fields)this.fields[t].id?(this.ids.push(this.fields[t].id[0]),this.fields[t].id.length>1&&(this.ids.push(this.fields[t].id[1]),this.timeArr=[this.fields[t].id[0],this.fields[t].id[1]])):this.ids.push(this.fields[t][0].id);for(var e=0;e<this.ids.length;e++)$("#"+this.ids[e]).val("").removeAttr("keyid")},getValue:function(){var t={};if(this.ids=this.ids||[],0==this.ids.length)for(var e in this.fields)this.fields[e].id?(this.ids.push(this.fields[e].id[0]),this.fields[e].id.length>1&&this.ids.push(this.fields[e].id[1])):this.ids.push(this.fields[e][0].id);for(var i=0;i<this.ids.length;i++){var a=$("#"+this.ids[i]).attr("keyid")||$("#"+this.ids[i]).val();this._cfg.isQry?t[this.ids[i]]=a:t[valueId[i]]=a}if(!this._cfg.allowEmpty)for(var e in t)""==t[e]&&delete t[e];return t},yearHandler:function(){if(this.year){var t=this;this.year.click(function(){t.clickFlag="year",$(this).addClass("active").siblings(".active").removeClass("active"),t.activeY=$(this).text(),t.request(t._cfg.refreshFn)})}},monthHandler:function(){if(this.month){var t=this;this.month.click(function(){t.clickFlag="month",$(this).addClass("active").siblings(".active").removeClass("active"),t.activeM=$(this).text()-0<10?"0"+$(this).text():$(this).text(),t.request(t._cfg.refreshFn)})}},quickHandler:function(){var t=this;this.quick.click(function(){var e=$(".yy-m-report-monthQuery"),i=$(this).index();$(t.year[0]).parent().fadeIn(100),2===i?(t.clickFlag="year",e.length>0&&e.fadeOut(100,function(){t.request(t._cfg.refreshFn)})):0===i&&(t.clickFlag="month",e.length>0&&e.fadeIn(100,function(){t.request(t._cfg.refreshFn)})),t.searchItem.hide(400),t.condition.each(function(){$(this).hasClass("active")&&$(this).removeClass("active")}),$(this).addClass("active").siblings(".active").removeClass("active"),$.each(t.custom,function(){if($(this).hasClass("active"))return $(this).removeClass("active"),!1}),t.formReset()})},conditionHandler:function(){var t=this;this.condition.click(function(){$(this).toggleClass("active"),t.searchItem.find(".yy-m-search-item>div").each(function(){$(this).find("input").length>1&&$(this).parent().hide()}),$(this).hasClass("active")?t.searchItem.show():t.searchItem.hide();var e;$.each(t.custom,function(){if($(this).hasClass("active"))return e=3,!1}),3==e?($(".yy-m-report-yearQuery").fadeIn(100),$(".yy-m-report-monthQuery").fadeIn(100)):"year"==t.clickFlag?$(".yy-m-report-yearQuery").fadeIn(100):$(".yy-m-report-monthQuery").fadeIn(100)})},customHandler:function(){var t=this;this.custom.click(function(){$(this).addClass("active").siblings(".active").removeClass("active"),$.each(t.quick,function(){if($(this).hasClass("active"))return $(this).removeClass("active"),!1}),t.searchItem.find(".yy-m-search-item>div").each(function(){$(this).find("input").length>1&&$(this).parent().show()}),$(this).hasClass("active")?t.searchItem.show():t.searchItem.hide(),t.year&&$(t.year[0]).parent().fadeOut(100),t.month&&$(t.month[0]).parent().fadeOut(100)})},request:function(t,e){var i,a;"year"===this.clickFlag?(i=this.activeY+"-01-01 "+this._cfg.start,a=this.activeY+"-12-31 "+this._cfg.end):(i=this.activeY+"-"+this.activeM+"-01 "+this._cfg.start,a=this.activeY+"-"+this.activeM+"-"+this.getMonthDays(this.activeY,this.activeM)+" "+this._cfg.end);var s=this.timeArr&&this.timeArr[0]||"stime",n=this.timeArr&&this.timeArr[1]||"etime",r={};r[s]=i,r[n]=a;var l=$.extend(r,e);t&&"function"===$.type(t)&&t(l)},treePopup:function(t){return t&&t.url?void(this.treeIndex=layer.open({type:2,area:["500px","300px"],title:t.title||"请选择部门",content:getContentPath()+t.url,btn:["确定"],yes:function(e,i){var a=$(i).find("iframe")[0].contentWindow,s=a.getSelected();s.arr.length>0&&t.elm.val(s.arr[0][s.name]).attr("keyid",s.arr[0].id),layer.close(e)}})):layer.msg("para error")},getMonthDays:function(t,e){var i=new Date(t,e,0);return i.getDate()},getTime:function(t,e){var e=($.extend({y:0,M:0,d:0,H:0,m:0,s:0,S:0},t),e||new Date);return new Date(e.getFullYear()+t.y,e.getMonth()+t.M,e.getDate()+t.d,e.getHours()+e.H,e.getMinutes()+t.m,vDate.getSeconds()+e.s,e.getMilliseconds()+e.S)},getStatus:function(){var t,e;return $.each(this.custom,function(){if($(this).hasClass("active"))return e=!0,!1}),e?3:("month"==this.clickFlag?t="0":"year"==this.clickFlag&&(t="1"),t)}},app.ui.report={init:function(t){return t.title&&(this.title=app.ui.reportTitle.init(t.title)),t.search&&(this.search=app.ui.reportSearch.init(t.search)),t.echart&&(t.echart.type||(t.echart.type="bar"),"pie"!==t.echart.type?this.echart=app.ui.echarts.barlineInit(t.echart):(delete t.echart.type,this.echart=app.ui.echarts.pieInit(t.echart))),t.grid&&(this.grid=app.ui.grid.init($.extend(t.grid,{elem:"#yui-grid"}))),this},getSearch:function(){return this.search},getTitle:function(){return this.title},getEchart:function(){return this.echart},getGrid:function(){return this.grid}},app.ui.data={get:function(t,e){var i;if(e.indexOf(".")===-1)i=t[e];else{i=t;for(var a=0;a<e.split(".").length;a++)i=i[e.split(".")[a]]}return i}},app.ui.monitorPopup={open:function(t){var e=layer.open({type:1,title:t.title,offset:t.offset,btn:t.btn||["确定","取消"],shade:t.btn||0,area:t.area,anim:app.ui.anim||4,yes:t.yes,content:t.content,success:t.success,end:t.end});return e}},app.ui.status={_cfg:{title:"平台运行情况",item:[],check:"查看运行情况"},init:function(t){$.extend(!0,this._cfg,t);var e=this,i=this._cfg,a="ycyaStatus",s="ycyaCheckStatus",n=$("<div/>",{class:"run-status-box",id:a}),r=$("<p/>",{class:"title",text:i.title}),l=$("<ul/>",{class:"run-status-list"}),o=$("<p/>",{class:"t-align cursor-point",id:s,text:i.check});return 0==i.item.length?layer.msg("status para error"):($.each(i.item,function(t,e){var a=["status-num","icon-"+e.class].join(" ");l.append($("<li/>",{"data-status":e.status,"data-title":e.title,width:1/i.item.length*100+"%",html:'<p class="'+a+'" data-status='+e.status+">"+e.num+"</p><p>"+e.text+"</p>"})[0].outerHTML)}),n.append(r).append(l).append(o),$("#mapWrap").length>0?$("#mapWrap").append(n):layer.msg("box  id is not exist"),this.list=$("#mapWrap .run-status-list"),this.checkElm=$("#"+s),i.toggle&&$("#mapWrap").append($("<div/>",{class:"run-status-box-toggle cursor-point",text:"运行情况>>",click:function(){$("#"+a).toggle(400),"23px"==$(this).css("left")?$(this).animate({left:330},400):$(this).animate({left:23},400)}})),i.itemClick&&this.list.on("click","li",function(){i.itemClick({status:$(this).attr("data-status"),title:$(this).attr("data-title")})}),i.checkClick&&(this.statusList=app.ui.statusList.init(i.checkClick),this.checkElm.click(function(){layer.open({type:1,area:"530px",title:t.checkClick.header&&t.checkClick.header.title||"运行情况",content:e.statusList.boxElm,anim:app.ui.anim,end:function(){e.statusList.boxElm.hide()}})})),this)},set:function(t){return"object"!==$.type(t)?layer.msg("status para error"):void this.list.find(".status-num").each(function(e,i){var a=t[$(this).attr("data-status")];void 0!==a&&$(this).text(a)})}},app.ui.tool={init:function(t){var e=this;this.ids=[],this.list=[],this.events=[];var i=$("<div/>",{class:"function-list",id:"toolList"});return $.each(t,function(t,a){var s=["iconfont","m-right-4",a.class].join(" "),n=["iconfont","m-left-4","font-small",a.up].join(" "),r=$("<li/>",{id:a.id,html:'<i class="'+s+'"></i><span>'+a.name+'</span><i class="'+n+'"></i>',class:a.cursor?"cursor-point":""});if(a.event){var l={id:a.id,event:a.event};"search"!=a.event&&"deptTree"!=a.event||(l.cfg=a.cfg),e.events.push(l)}if(a.item){var o=$("<ul/>",{class:"master-list tool-list"});$.each(a.item,function(t,e){var i=["iconfont","m-right-4",e.class].join(" "),a=$("<li/>",{click:e.handle,id:e.id,html:'<i class="'+i+'"></i>'+e.name});o.append(a)}),r.append(o).append('<div class="up-triangle master-list-triangle tool-list-triangle ycya-hide" ></div>'),e.list.push(a.id)}i.append(r),e.ids.push(a.id)}),$("#mapWrap").length>0?$("#mapWrap").append(i):layer.msg("box  id is not exist"),this.elms=[],$.each(this.ids,function(t,i){e.elms.push($("#"+i))}),this.ulshow(),this.customEvent(),this},ulshow:function(){var t=this;$.each(this.list,function(e,i){$("#"+i).on("click.toggle",function(){$(this).find("ul,.up-triangle").toggle(500),$(this).siblings().find("ul,.up-triangle").each(function(){$(this).hide()}),t.ycyaMapSearch&&t.ycyaMapSearch.boxElm.hide()})})},customEvent:function(){var t=this;$.each(this.events,function(e,i){if("deptTree"==i.event){t.ycyaMapDeptTree=app.ui.deptTree.init(i.cfg);var a=$(".map-wrap").width()-70-355-32;$("#"+i.id).on("click.custom",function(){app.ui.monitorPopup.open({title:"选择部门",offset:["82px",a],area:$("#toolList").innerWidth()+"px",yes:function(e,a){var s;$.each(t.events,function(t,e){"deptTree"==e.event&&(s=$("#"+e.id).find("span"))}),i.cfg.yes&&i.cfg.yes(e,s,t.ycyaMapDeptTree.tree.getSelectedNodes())},content:t.ycyaMapDeptTree.boxElm,success:function(){t.ycyaMapDeptTree.tree.cancelSelectedNode()},end:function(){t.ycyaMapDeptTree.boxElm.hide()}})})}else"search"==i.event&&(t.ycyaMapSearch=app.ui.searchBar.init(i.cfg),$("#"+i.id).on("click.custom",function(){t.ycyaMapSearch.boxElm.toggle(500),$(this).siblings("li").find("ul,.up-triangle").each(function(){$(this).hide()})}),$("."+i.cfg["primary-icon"],"#mapSearch").click(function(){var t=i.cfg.base;t.keyName&&(t.data[t.keyName]=$("input","#mapSearch").val()),t.search&&t.search(i.cfg.base)}))})}},app.ui.deptTree={_cfg:{data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId",rootPId:0},key:{name:"name"}},callback:{}},init:function(t){var e="ycyaDeptTree",i=$.extend(!0,this._cfg,t.cfg),a=this,s=$("<div/>",{class:"ycya-hide",id:"ycyaDeptBox"});if(s.append('<div class="dept-box popup-panel"><div class="ztree" id="'+e+'"></div></div>'),$("#mapWrap").length>0?$("#mapWrap").append(s):layer.msg("box  id is not exist"),this.boxElm=$("#ycyaDeptBox"),t.url)ycya.http.ajax(t.url,{data:t.data,type:t.type||"post",success:function(s,n,r){if(s&&0==s.code){var l=t.beforeSuccess?t.beforeSuccess(s):s.data;if(t.open)for(var o=0;o<l.length;o++)l[o].open=!0;var c=$.fn.zTree.init($("#"+e),i,l);a.tree=c,a.loaded=!0}},error:function(t,e,i){layer.msg("monitor tree data load err:"+e)}});else{var n=$.fn.zTree.init($("#"+e),i,t.data);a.tree=n,a.loaded=!0}return this}},app.ui.searchBar={init:function(t){var e="mapSearch",i=["iconfont",t["advanced-icon"]].join(" "),a=["iconfont",t["primary-icon"],"cursor-point"].join(" "),s=$("<div/>",{class:"map-search",id:e}),n=$("<span>",{class:"cursor-point",id:"seniorSearchBtn",html:'<i class="'+i+'"></i>'}),r=$("<span>",{html:'<i class="'+a+'"></i><strong><input placeholder="'+t.placeholder+'"></strong>'});return s.append(n).append(r),$("#mapWrap").length>0?$("#mapWrap").append(s):layer.msg("box  id is not exist"),this.boxElm=$("#"+e),this}},app.ui.mapHighSearch={},app.ui.master={init:function(t){var e=this;if(this.events=[],"array"!==$.type(t.item)||0==t.item.length)return layer.msg("monitor master para error");var i=$("<div/>",{class:"master-btn cursor-point",click:function(){$(this).find("ul,.up-triangle").toggle(500)}}),a=$("<i/>",{class:"iconfont "+t.class}),s=$("<div/>",{class:"up-triangle master-list-triangle ycya-hide"}),n=$("<ul/>",{class:"master-list"});return $.each(t.item,function(t,i){var a=["iconfont","m-right-4","positon-adjust-middle",i.class].join(" "),s=$("<li/>",{id:i.id,html:'<i class="'+a+'"></i>'+i.name});if(n.append(s),i.event){var r={id:i.id,event:i.event};"mapShow"==i.event&&(r.cfg=i.cfg),e.events.push(r)}}),i.append(a).append(n).append(s),$("#mapWrap").length>0?$("#mapWrap").append(i):layer.msg("box  id is not exist"),this.customEvent(),this},customEvent:function(){var t=this;$.each(this.events,function(e,i){if("mapShow"==i.event){t.ycyaMapShow=app.ui.mapShow.init(i.cfg);var a=$(".map-wrap").width()-70-355-32;$("#"+i.id).on("click.custom",function(){app.ui.monitorPopup.open({title:"地图显示设置",offset:["82px",a],area:$("#toolList").innerWidth()+"px",content:t.ycyaMapShow.boxElm,success:function(){},yes:function(e,a){var s=[];$(".choosed-type-item",t.ycyaMapShow.choosed).each(function(){s.push({id:$(this).attr("data-id"),type:$(this).attr("data-type"),name:$(this).text()})}),i.cfg.yes&&i.cfg.yes(e,s)},end:function(){t.ycyaMapShow.boxElm.hide()}})})}})}},app.ui.mapShow={init:function(t){var e=this;if(!t.names)return layer.msg("monitor mapShow popup para error");this.aliasNames=t.names;var i="ycyaMapShow",a=$("<div/>",{class:"ycya-hide",id:i}),s=$("<div/>",{class:"popup-panel show-box",html:'<div class="sub-title p-left-16">当前选择</div><div class="choosed-type"></div> <div class="choose-all p-left-16"><p class="to-choose-type-all">全部<i class="item-choosed"></i></p></div><ul class="to-choose-type clear p-left-16"></ul>'});return a.append(s),$("#mapWrap").length>0?$("#mapWrap").append(a):layer.msg("box  id is not exist"),this.boxElm=$("#"+i),this.toChoose=$(".to-choose-type",this.boxElm),this.choosed=$(".choosed-type",this.boxElm),this.all=$(".choose-all",this.boxElm),!t.cfg&&t.local?this.create(t.local.all,t.local.selected):ycya.http.ajax(t.cfg.url,{data:t.cfg.where,type:t.cfg.type||"post",success:function(i){var a=app.ui.data.get(i,t.cfg.format);e.create(a,a)}}),this},create:function(t,e){if(!t||!e||"array"!==$.type(t)||"array"!==$.type(e))return layer.msg("monitor mapShow popup para error");this.allList=t,this.selectedList=e;for(var i=[],a=[],s=this.aliasNames.id,n=this.aliasNames.name,r=this.aliasNames.type,l=0;l<t.length;l++){var o=t[l];i.push('<li class="to-choose-type-item" data-type='+o[r]+" data-id="+o[s]+">"+o[n]+'<i class="item-choosed"></i></li>')}this.toChoose.html(i.join("")),e.length>0&&(e.length==t.length?$(".to-choose-type li").each(function(){$(this).addClass("active"),a.push('<span class="choosed-type-item" data-type='+$(this).attr("data-type")+" data-id="+$(this).attr("data-id")+">"+$(this).text()+'<i class="choosed-type-item-close"></i></span>')}):$(".to-choose-type li").each(function(){for(var t=0;t<e.length;t++)e[t].name==$(this).text()&&($(this).addClass("active"),a.push('<span class="choosed-type-item" data-type='+$(this).attr("data-type")+" data-id="+$(this).attr("data-id")+">"+e[t].name+'<i class="choosed-type-item-close"></i></span>'))}),this.choosed.html(a.join("")),this.bindEvent())},bindEvent:function(){var t=this;return 0==$("#mapWrap").length?layer.msg("box id is not exist"):($("#mapWrap").on("click",".choosed-type-item-close",function(){
var e=$(this).parent().text();$(this).parent().remove(),$("li",t.toChoose).each(function(){if($(this).text()==e)return $(this).removeClass("active"),!1}),t.all.hasClass("active")&&t.all.removeClass("active"),0==t.choosed.find(".choosed-type-item").length&&t.choosed.hide(500)}),$(".to-choose-type-all").click(function(){if($(this).hasClass("active"))$(this).removeClass("active"),$(".to-choose-type li").each(function(){$(this).removeClass("active")}),t.choosed.hide(500).html("");else{$(this).addClass("active"),$("li",t.toChoose).each(function(){$(this).addClass("active")});var e=[];$("li",t.toChoose).each(function(){$(this).addClass("active"),e.push('<span class="choosed-type-item" data-type='+$(this).attr("data-type")+" data-id="+$(this).attr("data-id")+">"+$(this).text()+'<i class="choosed-type-item-close"></i></span>')}),t.choosed.show().html(e.join(""))}}),void $("#mapWrap").on("click",".to-choose-type-item",function(){if($(this).hasClass("active")){var e=$(this).text();$(this).removeClass("active"),$(".choosed-type-item",t.choosed).each(function(){if($(this).text()==e)return $(this).remove(),!1}),0==$(".choosed-type-item",t.choosed).length&&t.choosed.hide(500);var i=$(".to-choose-type-all",t.all);i.hasClass("active")&&i.removeClass("active")}else t.choosed.show(),$(this).addClass("active"),$(".active",t.toChoose).length==t.allList.length&&$(".to-choose-type-all",t.all).addClass("active"),$(".choosed-type").append('<span class="choosed-type-item" data-type='+$(this).attr("data-type")+" data-id="+$(this).attr("data-id")+">"+$(this).text()+'<i class="choosed-type-item-close"></i></span>')}))}},app.ui.zoom={_cfg:{id:"ycyaZoom"},init:function(t,e){$.extend(this._cfg,e);var i=$("<div/>",{class:"zomm-wrap",id:this._cfg.id}),a=$("<p/>",{class:"zoom-in",id:"zoomIn",title:"放大一级",text:"+",click:function(){t.zoomIn()}}),s=$("<p/>",{class:"zoom-out",id:"zoomOut",title:"缩小一级",text:"-",click:function(){t.zoomOut()}});return i.append(a).append(s),$("#mapWrap").length>0?$("#mapWrap").append(i):layer.msg("box id is not exist"),this}},app.ui.map={_cfg:{id:"ycyaMap"},init:function(t){return $.extend(this._cfg,t),new YcyaMap(this._cfg.id)}},app.ui.statusList={init:function(t){var e=this,i="ycyaRunStatus",a=$("<div/>",{id:i,class:"ycya-hide layui-layer-wrap"}),s=$("<div/>",{class:"well-box clear"}),n=$("<div/>",{class:"well-box-left-top"}),r=$("<div/>",{class:"well-box-left-bottom",html:'<p>报警:</p><p class="alarm">'+t.left.alarmNum||"0</p>"}),l=$("<div/>",{class:"well-box-left"}),o=$("<div/>",{class:"well-box-right"}),c=$("<p/>",{class:"title",text:t.left.title}),d=$("<p/>",{class:"num"}),h=this.createDivItem({name:"维护",num:t.left.repairNum,percent:t.left.repairNum/t.left.allNum*100,bg:"layui-bg-orange",class:"repair-bg"}),p=this.createDivItem({name:"离线",num:t.left.offNum,percent:t.left.offNum/t.left.allNum*100,bg:"layui-bg-gray",class:"off-bg"}),f=$("<ul/>",{class:"well-box-list"});return d.append('<span><i class="iconfont '+t.left.allIcon+'"></i><font>'+t.left.allNum||"0</font></span>").append('<span class="rt"><i class="iconfont '+t.left.typeIcon+'"></i><font>'+t.left.typeNum||"0</font></span>"),n.append(c).append(d).append(h).append(p),l.append(n).append(r),o.append(f),s.append(l).append(o),a.append(s),$("#mapWrap").length>0?$("#mapWrap").append(a):layer.msg("box id is not exist"),this.boxElm=$("#"+i),this.ul=$(".well-box-list","#"+i),this.leftElm={allNum:$(".num>span:eq(0)","#"+i),typeNum:$(".num>span.rt","#"+i),repairNum:$('.well-box-item[data-class="repair-bg"] strong',"#"+i),repairBar:$('.well-box-item[data-class="repair-bg"] .layui-progress-bar',"#"+i),offBar:$('.well-box-item[data-class="off-bg"] .layui-progress-bar',"#"+i),offNum:$('.well-box-item[data-class="off-bg"] strong',"#"+i),alarmNum:$(".well-box-left-bottom .alarm","#"+i)},t.right.item&&!t.right.cfg?this.createList(t.right,t.item):ycya.http.ajax(t.right.cfg.url,{data:t.where,type:t.right.cfg.type||"post",success:function(i){e.createList(t.right,app.ui.data.get(i,t.right.cfg.format))}}),this},createDivItem:function(t){return $("<div/>",{class:"well-box-item","data-class":t.class,html:"<span>"+t.name+'</span><strong class="rt">'+t.num+'</strong><div class="layui-progress"><div class="layui-progress-bar '+t.bg+'" style="width:'+t.percent+'%;"></div></div>'})},createList:function(t,e){var i=[],a=t.onKey,s=t.offKey,n=t.alarmKey,r=t.repairKey,l=t.nameKey;this.listCfg={on:a,off:s,alarm:n,repair:r,aliasName:l},this.listIcon=t.icon,$.each(e,function(e,o){i.push($("<li/>",{html:"<span>"+o[l]+'：</span><span><i class="iconfont icon-blue  '+t.icon+'"></i>'+o[a]+'</span><span><i class="iconfont icon-red  '+t.icon+'"></i>'+o[n]+'</span><span><i class="iconfont icon-yellow  '+t.icon+'"></i>'+o[r]+'</span><span><i class="iconfont icon-gray  '+t.icon+'"></i>'+o[s]+"</span>"})[0].outerHTML)}),this.ul.html(i.join(""))},listRender:function(t){var e=this,i=[];$.each(t,function(t,a){i.push($("<li/>",{html:"<span>"+a[e.listCfg.aliasName]+'：</span><span><i class="iconfont icon-blue  '+e.listIcon+'"></i>'+a[e.listCfg.on]+'</span><span><i class="iconfont icon-red  '+e.listIcon+'"></i>'+a[e.listCfg.alarm]+'</span><span><i class="iconfont icon-yellow  '+e.listIcon+'"></i>'+a[e.listCfg.repair]+'</span><span><i class="iconfont icon-gray  '+e.listIcon+'"></i>'+a[e.listCfg.off]+"</span>"})[0].outerHTML)}),this.ul.html(i.join(""))},set:function(t){$.each(this.leftElm,function(e,i){"repairBar"==e&&i.css({width:t.repairNum/t.allNum*100+"%"}),"offBar"==e&&i.css({width:t.offNum/t.allNum*100+"%"}),void 0!==t[e]&&("allNum"==e||"typeNum"==e?i.find("font").text(t[e]):i.text(t[e]))})}},app.ui.page.monitor={init:function(t){var e=this;return this.map=app.ui.map.init(t.map),e.status=app.ui.status.init(t.status),e.tool=app.ui.tool.init(t.tool),this.map.ready(function(){e.zoom=app.ui.zoom.init(e.map,t.zoom),e.master=app.ui.master.init(t.master),t.ready&&t.ready(e)}),this},getMap:function(){return this.map},getStatus:function(){return this.status}},app.ui.title={_cfg:{item:[],parent:"#bodyHeader"},init:function(t){$.extend(!0,this._cfg,t);var e=this._cfg,i=this;if("array"!==$.type(e.item))return new TypeError;var a="",s=1/e.item.length*100+"%";return $.each(e.item,function(t,n){var r=n.bgClass?"yy-title-bg-gradient-"+n.bgClass:"yy-title-bg-gradient-blue",l="number"==$.type(n.num-0)&&i.fmoney(n.num-0),o=t==e.item.length-1&&"padding-right:0";a+='<div style="width:'+s+";"+o+'" class="yy-height-all" ><div class="yy-height-all '+r+'"><p class="yy-titles-item-text">'+n.text+'</p><p><strong class="yy-titles-num yy-titles-bigfont" id="yyTitlesNum'+t+'">'+l+'</strong>/<span class="yy-titles-item-unit">'+n.unit+'</span><i class="yy-rt iconfont yy-titles-bigfont '+n.icon+'"></i></p></div></div> '}),$(this._cfg.parent).html(a),this.numList=$(".yy-titles-num",this._cfg.parent),this},set:function(t){var e=this;return"array"!=$.type(t)&&"object"!=$.type(t)?new TypeError:void $.each(t,function(t,i){$(e.numList[t]).text("number"==$.type(i-0)&&e.fmoney(i-0))})},fmoney:function(e,a){a=a>=0&&a<=20?a:2,e=parseFloat((e+"").replace(/[^\d\.-]/g,"")).toFixed(a)+"";var s=e.split(".")[0].split("").reverse();e.split(".")[1];for(t="",i=0;i<s.length;i++)t+=s[i]+((i+1)%3==0&&i+1!=s.length?",":"");return t.split("").reverse().join("")}},app.ui.devRun={_cfg:{parent:"#bodyDevRun"},init:function(t){if(!t.name||!t.cfg)return layer.msg("parking devRun para error");$.extend(!0,this._cfg,t);var e=($(this._cfg.parent),this._cfg),i=this;$(".layui-card-header",e.parent).text(e.title||"");var a=$("<thead/>"),s=$("<tbody/>"),n=$("<tr/>"),r=[],l=[];$.each(e.name,function(t,e){n.append($("<th>"+e.title+"</th>")),r.push(e.field),l.push(e.class)}),this.fields=r,a.append(n),$(".thead",e.parent).html(a[0].outerHTML),ycya.http.ajax(t.cfg.url,{data:t.cfg.data,type:t.cfg.type||"post",success:function(a){var n=t.cfg.beforeSuccess?t.cfg.beforeSuccess(a):a.data||[];$.each(n,function(t,e){for(var a=$("<tr/>"),n=0;n<i.fields.length;n++){var r=i.fields[n];a.append($("<td/>",{text:e[r],class:"yy-color-"+l[n]}))}s.append(a)}),$(".tbody",e.parent).html(s[0].outerHTML)}})}},app.ui.parkRank={_cfg:{parent:"#bodyParkRank"},init:function(t){if(!t.name||!t.cfg)return layer.msg("parking parkRank para error");$.extend(!0,this._cfg,t),this.numberKey=t.numberKey;var e=($(this._cfg.parent),this._cfg),i=this;$(".layui-card-header",e.parent).prepend($("<span/>",{text:e.title||""}));var a=$("<thead/>"),s=$("<tr/>"),n=[];$.each(e.name,function(t,e){s.append($("<th>"+e.title+"</th>")),n.push(e.field)}),this.fields=n,a.append(s),$(".thead",e.parent).html('<colgroup><col width="150"><col></colgroup>'+a[0].outerHTML),i.render(e.cfg[0]),$(".yy-parking-rank-ul").on("click","li",function(){$(this).addClass("active").siblings().removeClass("active"),i.render(e.cfg[$(this).index()])})},render:function(t){var e=this,i=$("<tbody/>");ycya.http.ajax(t.url,{data:t.data,type:t.type||"post",success:function(a){var s=t.beforeSuccess?t.beforeSuccess(a):a.data||[];$.each(s,function(t,a){if(t<7){for(var s=t<3?"yy-parking-tr"+(1+t):"",n=$("<tr/>",{class:s}),r=0;r<e.fields.length;r++){var l=e.fields[r];if(l==e.numberKey){var o;o=t<3?'<i class="yy-parking-no-position yy-no yy-no'+t+'"></i>':'<i class= "yy-no" style="margin-right:6px">'+(1+t)+"</i>",n.append($("<td/>",{html:o+a[l]}))}else n.append($("<td/>",{text:a[l]}))}i.append(n)}}),$(".tbody",e._cfg.parent).html("").html('<colgroup><col width="150"><col></colgroup>'+i[0].outerHTML)}})}},app.ui.page.parking={init:function(t){var e=this;if(t.header&&(this.header=app.ui.title.init(t.header)),t.map&&(this.map=app.ui.map.init(t.map),this.map.ready(function(){t.ready&&t.ready(e)})),t.devRun&&(this.devRun=app.ui.devRun.init(t.devRun)),t.parkRank&&(this.parkRank=app.ui.parkRank.init(t.parkRank)),t.parkSort&&"pie"==t.parkSort.type){var i="parksort";$(".layui-card-body","#bodyParkSort").append($("<div/>",{height:200,id:i})),$(".layui-card-header","#bodyParkSort").append($("<span/>",{text:t.parkSort.title||""})),$.extend(t.parkSort,{id:i}),this.parkSort=app.ui.echarts.pieInit(t.parkSort)}if(t.parkCurve&&("bar"==t.parkCurve.type||"line"==t.parkCurve.type)){var a="parkcurse";$(".layui-card-body","#bodyParkCurve").append($("<div/>",{height:300,id:a})),$(".layui-card-header","#bodyParkCurve").append($("<span/>",{text:t.parkCurve.title||""})),$.extend(t.parkCurve,{id:a}),this.parkCurve=app.ui.echarts.barlineInit(t.parkCurve)}return this},getHeader:function(){return this.header},getMap:function(){return this.map},getDevRun:function(){return this.devRun},getParkRank:function(){return this.parkRank},getParkSort:function(){return this.parkSort},getParkCurve:function(){return this.parkCurve}},$(function(){var t=GetQueryString("p");if(t){var e=app.router[t];if(e){var i=new YcyaLoader;i.loadFile(getContentPath()+e,function(){})}else alert("cfg error")}else alert("para error")});